<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="AutoImportSettings">
    <option name="autoReloadType" value="SELECTIVE" />
  </component>
  <component name="ChangeListManager">
    <list default="true" id="42f736d0-cfb7-49a1-a6e6-dcc95799e31b" name="Changes" comment="Update build processes for Docker and Astro&#10;&#10;This commit optimizes the Dockerfiles for both 'migrate-db' and 'email-worker' components, improving the order and efficiency of copy commands for necessary dependencies and modules. Furthermore, adjustments are made to Astro build scripts and page scripts for order calculation, aiming to enhance code consistency and efficiency.">
      <change afterPath="$PROJECT_DIR$/app/Dockerfile" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/.gitignore" beforeDir="false" afterPath="$PROJECT_DIR$/.gitignore" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/.idea/demo-sentry.iml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/demo-sentry.iml" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/app/package.json" beforeDir="false" afterPath="$PROJECT_DIR$/app/package.json" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/app/src/pages/api/orders/[orderId]/payment.ts" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/pages/api/orders/[orderId]/payment.ts" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/app/src/pages/orders/[orderId].astro" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/pages/orders/[orderId].astro" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/app/src/pages/products/[productId]/order.astro" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/pages/products/[productId]/order.astro" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/components/workers/email-worker/Dockerfile" beforeDir="false" afterPath="$PROJECT_DIR$/components/workers/email-worker/Dockerfile" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/components/workers/email-worker/build.ts" beforeDir="false" afterPath="$PROJECT_DIR$/components/workers/email-worker/build.ts" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/infra/main.tf" beforeDir="false" afterPath="$PROJECT_DIR$/infra/main.tf" afterDir="false" />
    </list>
    <option name="SHOW_DIALOG" value="false" />
    <option name="HIGHLIGHT_CONFLICTS" value="true" />
    <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" />
    <option name="LAST_RESOLUTION" value="IGNORE" />
  </component>
  <component name="FileTemplateManagerImpl">
    <option name="RECENT_TEMPLATES">
      <list>
        <option value="Liquid File" />
      </list>
    </option>
  </component>
  <component name="FormatOnSaveOptions">
    <option name="mySelectedFileTypes">
      <set>
        <option value="Handlebars/Mustache" />
        <option value="Prisma" />
        <option value="Terraform" />
      </set>
    </option>
  </component>
  <component name="Git.Settings">
    <option name="RECENT_BRANCH_BY_REPOSITORY">
      <map>
        <entry key="$PROJECT_DIR$" value="3e18bf5c6b4df47e2eb9991d01c2b531139e077c" />
      </map>
    </option>
    <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
  </component>
  <component name="MarkdownSettingsMigration">
    <option name="stateVersion" value="1" />
  </component>
  <component name="OptimizeOnSaveOptions">
    <option name="myRunOnSave" value="true" />
  </component>
  <component name="ProblemsViewState">
    <option name="selectedTabId" value="ProjectErrors" />
  </component>
  <component name="ProjectColorInfo">{
  &quot;customColor&quot;: &quot;&quot;,
  &quot;associatedIndex&quot;: 1
}</component>
  <component name="ProjectId" id="2ZXSVVwgrFhO7yARfg6IXKMCQcy" />
  <component name="ProjectViewState">
    <option name="hideEmptyMiddlePackages" value="true" />
    <option name="showLibraryContents" value="true" />
  </component>
  <component name="PropertiesComponent"><![CDATA[{
  "keyToString": {
    "RunOnceActivity.OpenProjectViewOnStart": "true",
    "RunOnceActivity.ShowReadmeOnStart": "true",
    "git-widget-placeholder": "migrate-to-astro",
    "last_opened_file_path": "/Users/khanh/WebStormProjects/demo-sentry/app",
    "node.js.detected.package.eslint": "true",
    "node.js.detected.package.standard": "true",
    "node.js.detected.package.stylelint": "true",
    "node.js.detected.package.tslint": "true",
    "node.js.selected.package.eslint": "(autodetect)",
    "node.js.selected.package.standard": "",
    "node.js.selected.package.stylelint": "",
    "node.js.selected.package.tslint": "(autodetect)",
    "nodejs_package_manager_path": "pnpm",
    "npm.demo-sentry > dev.executor": "Run",
    "prettierjs.PrettierConfiguration.Package": "/Users/khanh/WebStormProjects/demo-sentry/node_modules/prettier",
    "settings.editor.selected.configurable": "com.github.copilot.settings.ApplicationConfigurable",
    "ts.external.directory.path": "/Users/khanh/WebStormProjects/demo-sentry/node_modules/typescript/lib",
    "vue.rearranger.settings.migration": "true"
  },
  "keyToStringList": {
    "DatabaseDriversLRU": [
      "postgresql"
    ]
  }
}]]></component>
  <component name="RdControllerToolWindowsLayoutState" isNewUi="true">
    <layout>
      <window_info id="Space Code Reviews" show_stripe_button="false" />
      <window_info id="Bookmarks" show_stripe_button="false" side_tool="true" />
      <window_info id="Commit_Guest" show_stripe_button="false" />
      <window_info id="Pull Requests" show_stripe_button="false" />
      <window_info id="Merge Requests" show_stripe_button="false" />
      <window_info active="true" content_ui="combo" id="Project" order="0" visible="true" weight="0.32982045" />
      <window_info id="Commit" order="1" weight="0.25" />
      <window_info id="Structure" order="2" side_tool="true" weight="0.25" />
      <window_info anchor="bottom" id="TODO" show_stripe_button="false" />
      <window_info anchor="bottom" id="File Transfer" show_stripe_button="false" />
      <window_info anchor="bottom" id="TypeScript" show_stripe_button="false" />
      <window_info anchor="bottom" id="Version Control" order="0" />
      <window_info anchor="bottom" id="Problems View" order="2" />
      <window_info active="true" anchor="bottom" id="Terminal" order="3" visible="true" weight="0.3306092" />
      <window_info anchor="bottom" id="Services" order="4" />
      <window_info anchor="right" id="Endpoints" show_stripe_button="false" />
      <window_info anchor="right" content_ui="combo" id="Notifications" order="0" weight="0.25" />
      <window_info anchor="right" id="AIAssistant" order="1" weight="0.25" />
    </layout>
  </component>
  <component name="RecentsManager">
    <key name="CopyFile.RECENT_KEYS">
      <recent name="$PROJECT_DIR$/app" />
      <recent name="$PROJECT_DIR$/components/jobs/prisma-migrate-deploy" />
      <recent name="$PROJECT_DIR$/app/src/components/order" />
      <recent name="$PROJECT_DIR$/app/src/pages/api/products/[productId]/order" />
      <recent name="$PROJECT_DIR$/app/src/components/header" />
    </key>
    <key name="MoveFile.RECENT_KEYS">
      <recent name="$PROJECT_DIR$/app/src/components/order/payment" />
      <recent name="$PROJECT_DIR$/app/src/components" />
      <recent name="$PROJECT_DIR$/app/src/layouts" />
      <recent name="$PROJECT_DIR$/app-old" />
      <recent name="$PROJECT_DIR$/components/workers/email-worker/src" />
    </key>
  </component>
  <component name="RunManager">
    <configuration name="demo-sentry &gt; dev" type="js.build_tools.npm" nameIsGenerated="true">
      <package-json value="$PROJECT_DIR$/package.json" />
      <command value="run" />
      <scripts>
        <script value="dev" />
      </scripts>
      <node-interpreter value="project" />
      <envs />
      <method v="2" />
    </configuration>
  </component>
  <component name="SharedIndexes">
    <attachedChunks>
      <set>
        <option value="bundled-js-predefined-1d06a55b98c1-c44b541a36ca-JavaScript-WS-233.13135.92" />
      </set>
    </attachedChunks>
  </component>
  <component name="SpellCheckerSettings" RuntimeDictionaries="0" Folders="0" CustomDictionaries="0" DefaultDictionary="application-level" UseSingleDictionary="true" transferred="true" />
  <component name="TaskManager">
    <task active="true" id="Default" summary="Default task">
      <changelist id="42f736d0-cfb7-49a1-a6e6-dcc95799e31b" name="Changes" comment="" />
      <created>1702566955087</created>
      <option name="number" value="Default" />
      <option name="presentableId" value="Default" />
      <updated>1702566955087</updated>
      <workItem from="1702566956432" duration="74000" />
      <workItem from="1702567035892" duration="7000" />
      <workItem from="1702567048352" duration="1527000" />
      <workItem from="1702568861868" duration="67000" />
      <workItem from="1702568936237" duration="2550000" />
      <workItem from="1702597202892" duration="13023000" />
      <workItem from="1702619736028" duration="2439000" />
      <workItem from="1702647907610" duration="36234000" />
      <workItem from="1702771165733" duration="3609000" />
      <workItem from="1702825023520" duration="1335000" />
      <workItem from="1702838800947" duration="1954000" />
      <workItem from="1702860022862" duration="8394000" />
      <workItem from="1702872269109" duration="459000" />
      <workItem from="1702945835674" duration="8307000" />
      <workItem from="1702987342987" duration="9465000" />
      <workItem from="1703028695449" duration="305000" />
      <workItem from="1703029009683" duration="2554000" />
      <workItem from="1703031572302" duration="8435000" />
      <workItem from="1703120230299" duration="5253000" />
      <workItem from="1703125927097" duration="78000" />
      <workItem from="1703168440512" duration="4093000" />
      <workItem from="1703172547350" duration="224000" />
      <workItem from="1703172781721" duration="1632000" />
      <workItem from="1703207163875" duration="698000" />
      <workItem from="1703208623759" duration="691000" />
      <workItem from="1703209316549" duration="2460000" />
      <workItem from="1703211787252" duration="25000" />
      <workItem from="1703211875248" duration="1542000" />
      <workItem from="1703246752648" duration="2997000" />
      <workItem from="1703298893411" duration="10102000" />
      <workItem from="1703340745792" duration="8863000" />
      <workItem from="1703377294510" duration="9283000" />
      <workItem from="1703388348193" duration="5739000" />
    </task>
    <task id="LOCAL-00001" summary="finish astro configurations">
      <option name="closed" value="true" />
      <created>1703173563842</created>
      <option name="number" value="00001" />
      <option name="presentableId" value="LOCAL-00001" />
      <option name="project" value="LOCAL" />
      <updated>1703173563842</updated>
    </task>
    <task id="LOCAL-00002" summary="add more changes">
      <option name="closed" value="true" />
      <created>1703293994651</created>
      <option name="number" value="00002" />
      <option name="presentableId" value="LOCAL-00002" />
      <option name="project" value="LOCAL" />
      <updated>1703293994651</updated>
    </task>
    <task id="LOCAL-00003" summary="add db replicas">
      <option name="closed" value="true" />
      <created>1703380326773</created>
      <option name="number" value="00003" />
      <option name="presentableId" value="LOCAL-00003" />
      <option name="project" value="LOCAL" />
      <updated>1703380326773</updated>
    </task>
    <task id="LOCAL-00004" summary="add worker ready event">
      <option name="closed" value="true" />
      <created>1703380893560</created>
      <option name="number" value="00004" />
      <option name="presentableId" value="LOCAL-00004" />
      <option name="project" value="LOCAL" />
      <updated>1703380893560</updated>
    </task>
    <task id="LOCAL-00005" summary="Refine error logging in email worker&#10;&#10;Changed the error logging method in the email worker component. Instead of logging just the error message, the updated code now logs the entire error object as a JSON string. This provides more detailed debugging information when an error occurs.">
      <option name="closed" value="true" />
      <created>1703381409028</created>
      <option name="number" value="00005" />
      <option name="presentableId" value="LOCAL-00005" />
      <option name="project" value="LOCAL" />
      <updated>1703381409028</updated>
    </task>
    <task id="LOCAL-00006" summary="Update email worker to use ioredis package&#10;&#10;Switched from using default Redis to the ioredis package in the email worker component. The code now also logs the count of orders in the system, providing more insightful information for debugging.">
      <option name="closed" value="true" />
      <created>1703383860721</created>
      <option name="number" value="00006" />
      <option name="presentableId" value="LOCAL-00006" />
      <option name="project" value="LOCAL" />
      <updated>1703383860721</updated>
    </task>
    <task id="LOCAL-00007" summary="Remove console log for order count in email worker&#10;&#10;The console log that prints the count of orders in the system has been removed from the email worker. This clean-up enhances code readability and performance by eliminating unnecessary logging.">
      <option name="closed" value="true" />
      <created>1703385016563</created>
      <option name="number" value="00007" />
      <option name="presentableId" value="LOCAL-00007" />
      <option name="project" value="LOCAL" />
      <updated>1703385016563</updated>
    </task>
    <task id="LOCAL-00008" summary="Update schema index for environment-specific Prisma client initialization&#10;&#10;The schema index now initializes the Prisma client according to the environment. For production, it uses the readReplicas extension with the given DATABASE_REPLICA_URLS. In other environments, a standard PrismaClient is returned. This enhances performance in production and simplifies initialization elsewhere.">
      <option name="closed" value="true" />
      <created>1703385634325</created>
      <option name="number" value="00008" />
      <option name="presentableId" value="LOCAL-00008" />
      <option name="project" value="LOCAL" />
      <updated>1703385634325</updated>
    </task>
    <task id="LOCAL-00009" summary="Create Sentry demo project database and Redis in DigitalOcean &#10;&#10;Added a new DigitalOcean database and Redis cluster structure for the demo Sentry project which includes a main database, two replicas and a connection pool, also added firewall rules to these resources. Various environment variables have been updated in the main application to utilize these new database resources. Additionally, the default SSH key resource has been removed.">
      <option name="closed" value="true" />
      <created>1703385657998</created>
      <option name="number" value="00009" />
      <option name="presentableId" value="LOCAL-00009" />
      <option name="project" value="LOCAL" />
      <updated>1703385657998</updated>
    </task>
    <task id="LOCAL-00010" summary="Create Sentry demo project database and Redis in DigitalOcean &#10;&#10;Added a new DigitalOcean database and Redis cluster structure for the demo Sentry project which includes a main database, two replicas and a connection pool, also added firewall rules to these resources. Various environment variables have been updated in the main application to utilize these new database resources. Additionally, the default SSH key resource has been removed.">
      <option name="closed" value="true" />
      <created>1703385674055</created>
      <option name="number" value="00010" />
      <option name="presentableId" value="LOCAL-00010" />
      <option name="project" value="LOCAL" />
      <updated>1703385674055</updated>
    </task>
    <task id="LOCAL-00011" summary="Add migrate-db job and update dependencies&#10;&#10;Added a new job 'migrate-db' that sets up a Docker container to manage database migrations. Dependencies for this job have been included in package.json files for Docker setups. Also updated the paths of dependencies in existing Dockerfile of the 'email-worker'.">
      <option name="closed" value="true" />
      <created>1703386428510</created>
      <option name="number" value="00011" />
      <option name="presentableId" value="LOCAL-00011" />
      <option name="project" value="LOCAL" />
      <updated>1703386428510</updated>
    </task>
    <task id="LOCAL-00012" summary="Add migrate-db job to infrastructure&#10;&#10;This commit adds a new job named &quot;migrate-db&quot; to the main.tf Terraform file. It also removes the unnecessary NODE_ENV setting in the Dockerfile associated with the migrate-db job. This new job will handle database migrations in our infrastructure. The required environment variables have been set up for this job to run successfully.">
      <option name="closed" value="true" />
      <created>1703388653764</created>
      <option name="number" value="00012" />
      <option name="presentableId" value="LOCAL-00012" />
      <option name="project" value="LOCAL" />
      <updated>1703388653764</updated>
    </task>
    <task id="LOCAL-00013" summary="Adjust Dockerfile copy actions for email-worker and migrate-db&#10;&#10;This commit reorders the Dockerfile copy actions for email-worker, and includes essential files to migrate-db's Dockerfile. The change in email-worker aims to ensure the Prisma modules are copied before the application build. For the migrate-db, Prisma schema and package files are now copied to properly set up the migration environment.">
      <option name="closed" value="true" />
      <created>1703389320776</created>
      <option name="number" value="00013" />
      <option name="presentableId" value="LOCAL-00013" />
      <option name="project" value="LOCAL" />
      <updated>1703389320776</updated>
    </task>
    <task id="LOCAL-00014" summary="Update Dockerfile of migrate-db and email-worker&#10;&#10;The Dockerfile of both migrate-db and email-worker have been updated to optimize copy actions and file inclusion. The copy actions in email-worker are rearranged to make sure Prisma modules are copied before application build, while for migrate-db, essential schema and package files are now included to properly set up the migration environment.">
      <option name="closed" value="true" />
      <created>1703390371830</created>
      <option name="number" value="00014" />
      <option name="presentableId" value="LOCAL-00014" />
      <option name="project" value="LOCAL" />
      <updated>1703390371830</updated>
    </task>
    <task id="LOCAL-00015" summary="Optimize Dockerfile for migrate-db and email-worker&#10;&#10;The Dockerfile of migrate-db and email-worker have been modified to streamline the build process. The focus is on improving the order and efficiency of copy commands to ensure necessary dependencies and modules, such as the Prisma modules in the email-worker, are effectively and accurately copied over for the application builds.">
      <option name="closed" value="true" />
      <created>1703390463255</created>
      <option name="number" value="00015" />
      <option name="presentableId" value="LOCAL-00015" />
      <option name="project" value="LOCAL" />
      <updated>1703390463255</updated>
    </task>
    <option name="localTasksCounter" value="16" />
    <servers />
  </component>
  <component name="TypeScriptGeneratedFilesManager">
    <option name="version" value="3" />
  </component>
  <component name="Vcs.Log.Tabs.Properties">
    <option name="TAB_STATES">
      <map>
        <entry key="MAIN">
          <value>
            <State />
          </value>
        </entry>
      </map>
    </option>
  </component>
  <component name="VcsManagerConfiguration">
    <MESSAGE value="finish astro configurations" />
    <MESSAGE value="add more changes" />
    <MESSAGE value="add db replicas" />
    <MESSAGE value="add worker ready event" />
    <MESSAGE value="Refine error logging in email worker&#10;&#10;Changed the error logging method in the email worker component. Instead of logging just the error message, the updated code now logs the entire error object as a JSON string. This provides more detailed debugging information when an error occurs." />
    <MESSAGE value="Update email worker to use ioredis package&#10;&#10;Switched from using default Redis to the ioredis package in the email worker component. The code now also logs the count of orders in the system, providing more insightful information for debugging." />
    <MESSAGE value="Remove console log for order count in email worker&#10;&#10;The console log that prints the count of orders in the system has been removed from the email worker. This clean-up enhances code readability and performance by eliminating unnecessary logging." />
    <MESSAGE value="Update schema index for environment-specific Prisma client initialization&#10;&#10;The schema index now initializes the Prisma client according to the environment. For production, it uses the readReplicas extension with the given DATABASE_REPLICA_URLS. In other environments, a standard PrismaClient is returned. This enhances performance in production and simplifies initialization elsewhere." />
    <MESSAGE value="Create Sentry demo project database and Redis in DigitalOcean &#10;&#10;Added a new DigitalOcean database and Redis cluster structure for the demo Sentry project which includes a main database, two replicas and a connection pool, also added firewall rules to these resources. Various environment variables have been updated in the main application to utilize these new database resources. Additionally, the default SSH key resource has been removed." />
    <MESSAGE value="Add migrate-db job and update dependencies&#10;&#10;Added a new job 'migrate-db' that sets up a Docker container to manage database migrations. Dependencies for this job have been included in package.json files for Docker setups. Also updated the paths of dependencies in existing Dockerfile of the 'email-worker'." />
    <MESSAGE value="Add migrate-db job to infrastructure&#10;&#10;This commit adds a new job named &quot;migrate-db&quot; to the main.tf Terraform file. It also removes the unnecessary NODE_ENV setting in the Dockerfile associated with the migrate-db job. This new job will handle database migrations in our infrastructure. The required environment variables have been set up for this job to run successfully." />
    <MESSAGE value="Adjust Dockerfile copy actions for email-worker and migrate-db&#10;&#10;This commit reorders the Dockerfile copy actions for email-worker, and includes essential files to migrate-db's Dockerfile. The change in email-worker aims to ensure the Prisma modules are copied before the application build. For the migrate-db, Prisma schema and package files are now copied to properly set up the migration environment." />
    <MESSAGE value="Update Dockerfile of migrate-db and email-worker&#10;&#10;The Dockerfile of both migrate-db and email-worker have been updated to optimize copy actions and file inclusion. The copy actions in email-worker are rearranged to make sure Prisma modules are copied before application build, while for migrate-db, essential schema and package files are now included to properly set up the migration environment." />
    <MESSAGE value="Optimize Dockerfile for migrate-db and email-worker&#10;&#10;The Dockerfile of migrate-db and email-worker have been modified to streamline the build process. The focus is on improving the order and efficiency of copy commands to ensure necessary dependencies and modules, such as the Prisma modules in the email-worker, are effectively and accurately copied over for the application builds." />
    <MESSAGE value="Update build processes for Docker and Astro&#10;&#10;This commit optimizes the Dockerfiles for both 'migrate-db' and 'email-worker' components, improving the order and efficiency of copy commands for necessary dependencies and modules. Furthermore, adjustments are made to Astro build scripts and page scripts for order calculation, aiming to enhance code consistency and efficiency." />
    <option name="LAST_COMMIT_MESSAGE" value="Update build processes for Docker and Astro&#10;&#10;This commit optimizes the Dockerfiles for both 'migrate-db' and 'email-worker' components, improving the order and efficiency of copy commands for necessary dependencies and modules. Furthermore, adjustments are made to Astro build scripts and page scripts for order calculation, aiming to enhance code consistency and efficiency." />
  </component>
</project>